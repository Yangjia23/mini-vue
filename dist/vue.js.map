{"version":3,"file":"vue.js","sources":["../src/utils/index.js","../src/observer/array.js","../src/observer/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["export function isObject (obj) {\n  return (obj && typeof obj === 'object')\n}\n\nexport function isArray (list) {\n  return Array.isArray(list)\n}","let oldArrayMethods = Array.prototype\n\nexport let arrayMethods = Object.create(oldArrayMethods)\n\n// 能够修改数组的方法, 进行重写拦截\nconst methods = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'sort',\n  'reverse',\n  'splice'\n]\n\nmethods.forEach(method => {\n  arrayMethods[method] = function (...args) {\n    const ob = this.__ob__\n    // 执行数组方法默认的逻辑\n    const result = oldArrayMethods[method].apply(this, args)\n    // 对于 push, unshift, splice 会往数组中添加新的元素，\n    // 如果新的元素是个对象，也需要对这个对象进行监测\n    let inserted\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        inserted = args\n        break;\n      case 'splice':\n        inserted = args.slice(2)\n        break;\n    }\n    inserted && ob.observerArray(inserted)\n    return result\n  }\n})","import {isObject, isArray} from '../utils/index'\nimport {arrayMethods} from './array'\n\nclass Observer{\n  constructor (data) {\n    // 标识\n    Object.defineProperty(data, '__ob__', {\n      enumerable: false,\n      configurable: false,\n      value: this\n    })\n\n    // 相对于对对象中每个属性做监测，很少会对数组中的每一项做监测\n    // ps: 1、数组可能很大，2、很少通过数组下标修改值 arr[10] = xxx \n    // 所以数组和对象的监测需要区分开\n    if (isArray(data)) {\n      // vue 对数组的监测，采用的是 函数劫持\n      // 对能够修改原数组的方法，进行重写\n      data.__proto__ = arrayMethods;\n      // 如果是个对象数组，需要对数组中每个对象进行监测\n      this.observerArray(data)\n    } else {\n      this.walk(data) // 对数据一步一步处理\n    }\n  }\n  observerArray(data) {\n    for (let i = 0; i < data.length; i++) {\n      observer(data[i])\n    }\n  }\n  walk (data) {\n    Object.keys(data).forEach(key => {\n      defineReactive(data, key, data[key])\n    })\n  }\n}\n\nfunction defineReactive(target, key, value) {\n  observer(value) // 如果 value 是个对象，就需要做递归循环检测\n  Object.defineProperty(target, key, {\n    get () {\n      return value\n    },\n    set (newValue) {\n      if (newValue === value) return\n      observer(newValue) //如果 newValue 是个对象，也需要做递归循环检测\n      value = newValue\n    }\n  })\n}\n\nexport function observer(data) {\n  // vue 2 中，通过 defineProperty 来实现响应式原理\n  if (!isObject(data)) {\n    return\n  }\n  if(data.__ob__ instanceof Observer){ // 防止对象被重复观测\n    return ;\n  }\n  return new Observer(data)\n}","import {observer} from './observer/index'\n\nexport function initState(vm) {\n  const opts = vm.$options \n\n  if (opts.props) {\n    initProps(vm)\n  }\n  if (opts.data) {\n    initData(vm)\n  }\n}\n\nfunction initProps() {}\n\nfunction initData(vm) {\n  // 获取到用户传入的data 参数\n  // data 可以是对象，也可以是个函数，若是函数，获取函数返回值\n\n  let data = vm.$options.data\n  // 实例 vm 通过 $data 就可以访问检测后的数据\n  data = vm.$data = typeof data === 'function' ? data.call(vm) : data\n  // 观测数据\n  observer(data)\n}","import {initState} from './state.js'\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this\n    vm.$options = options // 用户传入的参数\n    initState(vm) // 初始化状态\n  }\n}","import {initMixin} from './init.js'\n\nfunction Vue(options) {\n  // 内部初始化操作\n  this._init(options) \n}\n\ninitMixin(Vue)\n\nexport default Vue"],"names":["isObject","obj","isArray","list","Array","oldArrayMethods","prototype","arrayMethods","Object","create","methods","forEach","method","ob","__ob__","args","result","apply","inserted","slice","observerArray","Observer","data","defineProperty","enumerable","configurable","value","__proto__","walk","i","length","observer","keys","key","defineReactive","target","get","set","newValue","initState","vm","opts","$options","props","initData","$data","call","initMixin","Vue","_init","options"],"mappings":"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"}